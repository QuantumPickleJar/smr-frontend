{"version":3,"file":"TagList.d9a89b60.js","sources":["../../../../../../src/lib/components/utils/TagList.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { GetTagsDocument } from '$lib/generated/graphql';\n  import type { Tag } from '$lib/generated/graphql';\n  import { queryStore, getContextClient } from '@urql/svelte';\n  import { Autocomplete, type AutocompleteOption, InputChip, type PopupSettings, popup } from '@skeletonlabs/skeleton';\n  import { onMount } from 'svelte';\n\n  const client = getContextClient();\n\n  const getAllTags = queryStore({\n    query: GetTagsDocument,\n    client,\n    variables: {}\n  });\n\n  export let tags: Tag[] = [];\n  export let editable = false;\n\n  $: allTags =\n    $getAllTags.data?.getTags?.map((t) => ({\n      label: t.name,\n      value: t.id\n    })) || ([] satisfies AutocompleteOption[]);\n\n  const popupSettings: PopupSettings = {\n    event: 'focus-click',\n    target: 'popupAutocomplete',\n    placement: 'bottom-start'\n  };\n\n  let tagList = [];\n  const loadTagList = () => (tagList = tags.map((t) => t.name));\n\n  onMount(loadTagList);\n\n  const addTag = (tag: AutocompleteOption) => {\n    tags = [\n      ...tags,\n      {\n        id: tag.value,\n        name: tag.label\n      }\n    ];\n\n    loadTagList();\n  };\n\n  const removeTag = (label: string) => {\n    const idx = tags.findIndex((t) => t.name === label);\n    tags = [...tags.slice(0, idx), ...tags.slice(idx + 1)];\n\n    loadTagList();\n  };\n\n  let inputTag = '';\n</script>\n\n<div class=\"tags\">\n  {#if !editable}\n    {#if tags.length > 0}\n      <div class=\"flex flex-row flex-wrap text-sm gap-1\">\n        {#each tags as tag}\n          <div class=\"text-neutral-300 lowercase\">\n            <span class=\"text-orange-500\">#</span>{tag.name}\n          </div>\n        {/each}\n      </div>\n    {/if}\n  {:else}\n    <div class=\"mb-2\">Tags</div>\n\n    <div use:popup={popupSettings}>\n      <InputChip\n        bind:input={inputTag}\n        bind:value={tagList}\n        on:remove={(t) => removeTag(t.detail.chipValue)}\n        name=\"tags\"\n        chips=\"variant-filled-primary\" />\n    </div>\n\n    <div class=\"card w-full max-w-sm max-h-48 p-4 overflow-y-auto\" tabindex=\"-1\" data-popup=\"popupAutocomplete\">\n      <Autocomplete\n        bind:input={inputTag}\n        options={allTags.filter((t) => tagList.indexOf(t.label) < 0)}\n        on:selection={(t) => addTag(t.detail)} />\n    </div>\n  {/if}\n</div>\n"],"names":["ctx","options","filter","insert_hydration_dev","target","div0","anchor","div1","div2","dirty","autocomplete_changes","length","create_if_block_1","i","div","t1_value","name","append_hydration_dev","span","set_data_dev","t1","client","getContextClient","getAllTags","queryStore","query","GetTagsDocument","variables","tags","$$props","editable","popupSettings","event","placement","tagList","loadTagList","$$invalidate","map","t","onMount","addTag","tag","id","value","label","removeTag","idx","findIndex","slice","inputTag","remove_handler","detail","chipValue","indexOf","selection_handler","allTags","$getAllTags","data","getTags"],"mappings":"qoBAyEoBA,EAAQ,CAAA,IAAA,iBAARA,EAAQ,CAAA,GACRA,EAAO,CAAA,IAAA,iBAAPA,EAAO,8IASVC,QAAAD,GAAQE,EAAAA,OAAMF,EAAA,EAAA,CAAA,CAAA,EADXA,EAAQ,sBAARA,EAAQ,CAAA,4HAbN,6IAAA,MAAA,kaAAlBG,EAA2BC,EAAAC,EAAAC,iBAE3BH,EAAAA,EAOKC,EAAAG,EAAAD,uBAELH,EAAAA,EAKKC,EAAAI,EAAAF,CAAAA,4CAdWN,EAAa,CAAA,CAAA,CAAA,2DAEbA,EAAQ,uCACRA,EAAO,qCASVS,EAAA,KAAAC,EAAAT,QAAAD,KAAQE,OAAMF,EAAA,EAAA,CAAA,0BADXA,EAAQ,yVAvBnBA,EAAI,CAACW,EAAAA,OAAS,GAACC,EAAAZ,gIAAfA,EAAI,CAAA,EAACW,OAAS,6OAERX,EAAI,iCAATW,OAAIE,GAAA,sTADRV,EAMKC,EAAAU,EAAAR,CAAAA,8EALIN,EAAI,CAAA,yBAATW,OAAIE,GAAA,EAAA,kHAAJF,6KAEyCI,EAAAf,MAAIgB,KAAI,wDAAjB,uHAAA,oMADhCb,EAEKC,EAAAU,EAAAR,CAAAA,EADHW,EAAsCH,EAAAI,CAAAA,uCAAC,CAAAT,EAAA,GAAAM,KAAAA,EAAAf,IAAIgB,EAAAA,KAAI,KAAAG,GAAAC,EAAAL,8MALnDf,EAAQ,CAAA,IAAA,2NADhBG,EA8BKC,EAAAU,EAAAR,CAAAA,uaAhFG,MAAAe,EAASC,IAETC,EAAaC,EAAU,CAC3BC,MAAOC,GACPL,OACAM,EAAAA,UAAS,CAAA,CAAA,CAAA,kDAGAC,EAAI,CAAAC,CAAAA,EAAAA,GACJC,SAAAA,EAAW,IAAKD,QAQrBE,EAAa,CACjBC,MAAO,cACP5B,OAAQ,oBACR6B,UAAW,oBAGTC,EAAO,SACLC,EAAW,IAAAC,EAAA,EAAUF,EAAUN,EAAKS,IAAKC,GAAMA,EAAEtB,OAEvDuB,EAAQJ,CAAAA,EAEF,MAAAK,EAAUC,GAAAA,CACdL,EAAA,EAAAR,EACK,CAAAA,GAAAA,EAED,CAAAc,GAAID,EAAIE,MACR3B,KAAMyB,EAAIG,KAAAA,CAAAA,CAAAA,EAIdT,EAAW,CAAA,EAGPU,EAAaD,GAAAA,OACXE,EAAMlB,EAAKmB,UAAWT,IAAMA,GAAEtB,OAAS4B,GAC7CR,EAAA,EAAAR,EAAW,CAAAA,GAAAA,EAAKoB,MAAM,EAAGF,CAASlB,EAAAA,GAAAA,EAAKoB,MAAMF,EAAM,CAAA,CAAA,CAAA,EAEnDX,EAAW,CAAA,EAGT,IAAAc,EAAW,0LAmBGA,EAAQN,uBACRT,EAAOS,SACP,MAAAO,EAAAZ,GAAMO,EAAUP,EAAEa,OAAOC,aAQZd,GAAMJ,EAAQmB,QAAQf,EAAEM,KAAS,EAAA,gBAD9CK,EAAQN,SAEL,MAAAW,EAAAhB,GAAME,EAAOF,EAAEa,MAAAA,ylBAlEnCf,EAAA,EAAEmB,EACDC,EAAYC,MAAMC,SAASrB,IAAKC,IAC9B,CAAAM,MAAON,EAAEtB,KACT2B,MAAOL,EAAEI,EAAA,EAAA,GAAA,CAAA,CAAA"}