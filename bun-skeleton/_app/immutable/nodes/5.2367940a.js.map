{"version":3,"file":"5.2367940a.js","sources":["../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.ts","../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\nexport const load: PageLoad = async ({ params }) => ({\n  ...params\n});\n","<script lang=\"ts\">\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { GetSmlVersionAdminDocument, UpdateSmlVersionDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import type { SMLVersionData } from '$lib/models/sml-versions';\n  import SMLVersionForm from '$lib/components/sml-versions/SMLVersionForm.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import type { PageData } from './$types';\n\n  export let data: PageData;\n\n  const { smlVersionId } = data;\n\n  const client = getContextClient();\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  const smlVersion = queryStore({\n    query: GetSmlVersionAdminDocument,\n    client,\n    variables: { smlVersionID: smlVersionId }\n  });\n\n  const onSubmit = (smlVersionData: SMLVersionData) => {\n    client\n      .mutation(UpdateSmlVersionDocument, {\n        smlVersionID: smlVersionId,\n        smlVersion: smlVersionData\n      })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          errorMessage = 'Error editing SMLVersion: ' + value.error.message;\n          errorToast = true;\n        } else {\n          // TODO Toast or something\n          goto(base + '/admin/sml-versions');\n        }\n      });\n  };\n\n  $: if (!errorToast) {\n    errorMessage = '';\n  }\n\n  $: initialValues = $smlVersion.data\n    ? ({\n        ...$smlVersion.data.getSMLVersion,\n        logo: undefined\n      } as unknown as SMLVersionData)\n    : undefined;\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Edit SML Version\" title=\"Admin: Edit SML Version\" />\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit SMLVersion</h1>\n\n<div class=\"card p-4\">\n  <section>\n    {#if $smlVersion.fetching}\n      <p>Loading...</p>\n    {:else if $smlVersion.error}\n      <p>Oh no... {$smlVersion.error.message}</p>\n    {:else}\n      <SMLVersionForm {onSubmit} {initialValues} editing submitText=\"Save\" />\n    {/if}\n  </section>\n</div>\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":["load","async","params","ctx","error","message","insert_hydration_dev","target","p","anchor","set_data_dev","t1","t1_value","span","fetching","h1","div","append_hydration_dev","section","data","$$props","smlVersionId","client","getContextClient","errorMessage","errorToast","smlVersion","queryStore","query","GetSmlVersionAdminDocument","variables","smlVersionID","onSubmit","smlVersionData","mutation","UpdateSmlVersionDocument","toPromise","then","value","console","$$invalidate","goto","base","initialValues","$smlVersion","getSMLVersion","logo","undefined"],"mappings":"kiBAEO,MAAMA,GAAiBC,MAASC,CAAAA,OAAAA,CAAAA,KAAc,CAChDA,GAAAA,CAAAA,gsBCiEcC,EAAW,CAAA,EAACC,MAAMC,QAAO,wCAAnC,2EAAA,4FAAHC,EAA0CC,EAAAC,EAAAC,8CAA7BN,EAAW,GAACC,MAAMC,QAAO,KAAAK,GAAAC,EAAAC,uLAFnC,qEAAA,YAAA,wEAAHN,EAAgBC,EAAAC,EAAAC,8NAUbN,EAAY,8DAAZA,EAAY,0EAAnBG,EAA0BC,EAAAM,EAAAJ,qCAAnBN,EAAY,0UAXZ,CAAA,OAAAA,GAAYW,EAAAA,SAAQ,EAEfX,KAAYC,MAAK,+FAQVD,EAAU,wBAAVA,EAAU,8HAdK,iBAAA,gNAAA,+VAApCG,EAAuDC,EAAAQ,EAAAN,mBAEvDH,EAUKC,EAAAS,EAAAP,CATHQ,EAAAA,EAQSD,EAAAE,yQAGUf,EAAU,kZAhElBgB,GAAcC,EAEjB,KAAA,CAAAC,aAAAA,CAAiBF,EAAAA,EAEnBG,EAASC,IAEX,IAAAC,EAAe,GACfC,EAAa,GAEX,MAAAC,EAAaC,EAAU,CAC3BC,MAAOC,EACPP,SACAQ,UAAS,CAAIC,aAAcV,yCAGvB,CAAA,EAAA,MAAAW,EAAYC,GAAAA,CAChBX,EACGY,SAASC,EAAwB,CAChCJ,aAAcV,EACdK,WAAYO,CAEbG,CAAAA,EAAAA,UAAAA,EACAC,KAAMC,GAAAA,CACDA,EAAMlC,OACRmC,QAAQnC,MAAMkC,EAAMlC,MAAMC,OAC1BmC,EAAAA,EAAA,EAAAhB,EAAe,6BAA+Bc,EAAMlC,MAAMC,OAAAA,EAC1DmC,EAAA,EAAAf,EAAa,KAGbgB,EAAKC,EAAO,gVAmCDjB,CAAAA,EAAUa,+kBA9BrBb,GACNe,EAAA,EAAAhB,EAAe,mBAGdgB,EAAA,EAAAG,EAAgBC,EAAYzB,SAEtByB,EAAYzB,KAAK0B,cACpBC,KAAMC,MAERA,EAAAA,MAAAA"}