import{S as $t,i as vt,d as B,s as Tt,v as yt,F as V,G as J,$ as kt,a0 as bt,a1 as K,a2 as nt,a3 as at,_ as Nt,e as w,g as x,h as P,j as h,O as R,m as D,n as k,t as j,q as st,r as F,y as St,V as M,p as ot,J as it,b as Q,K as I,M as ct,k as q,N as A,Q as lt,R as N,Y as _,T as rt,X as ft,u as H,f as W,W as wt,a4 as X,a5 as xt}from"../chunks/vendor.eef57579.js";import{a as Y,C as z,b as Z,U as tt}from"../chunks/graphql.fef59309.js";const{console:Dt}=Nt,E="src/routes/admin/tag-manager/+page.svelte";function et(o,t,a){const n=o.slice();return n[16]=t[a],n[17]=t,n[18]=a,n}function ut(o){let t,a,n,e,f,c,s,l,u,i,m,$;t=new nt({props:{$$slots:{default:[pt]},$$scope:{ctx:o}},$$inline:!0});const C={c:function(){it(t.$$.fragment),a=Q(),n=w("section"),e=w("button"),f=w("span"),c=I("Add new tag"),s=Q(),l=w("span"),u=I("add"),this.h()},l:function(d){ct(t.$$.fragment,d),a=q(d),n=x(d,"SECTION",{class:!0});var v=P(n);e=x(v,"BUTTON",{class:!0});var S=P(e);f=x(S,"SPAN",{});var O=P(f);c=A(O,"Add new tag"),O.forEach(h),s=q(S),l=x(S,"SPAN",{class:!0});var b=P(l);u=A(b,"add"),b.forEach(h),S.forEach(h),v.forEach(h),this.h()},h:function(){D(f,E,147,8,4498),R(l,"class","material-icons"),D(l,E,148,8,4531),R(e,"class","btn variant-ghost-primary"),D(e,E,146,6,4429),R(n,"class","p-4"),D(n,E,145,4,4401)},m:function(d,v){lt(t,d,v),k(d,a,v),k(d,n,v),N(n,e),N(e,f),N(f,c),N(e,s),N(e,l),N(l,u),i=!0,m||($=_(e,"click",o[4],!1,!1,!1,!1),m=!0)},p:function(d,v){const S={};v&524294&&(S.$$scope={dirty:v,ctx:d}),t.$set(S)},i:function(d){i||(F(t.$$.fragment,d),i=!0)},o:function(d){j(t.$$.fragment,d),i=!1},d:function(d){rt(t,d),d&&h(a),d&&h(n),m=!1,$()}};return B("SvelteRegisterBlock",{block:C,id:ut.name,type:"else",source:"(123:2) {:else}",ctx:o}),C}function gt(o){let t,a,n=o[0].error.message+"",e;const f={c:function(){t=w("h1"),a=I("Failed to load tags: "),e=I(n),this.h()},l:function(s){t=x(s,"H1",{});var l=P(t);a=A(l,"Failed to load tags: "),e=A(l,n),l.forEach(h),this.h()},h:function(){D(t,E,121,4,3579)},m:function(s,l){k(s,t,l),N(t,a),N(t,e)},p:function(s,l){l&1&&n!==(n=s[0].error.message+"")&&ft(e,n)},i:H,o:H,d:function(s){s&&h(t)}};return B("SvelteRegisterBlock",{block:f,id:gt.name,type:"if",source:"(121:29) ",ctx:o}),f}function mt(o){let t,a;const n={c:function(){t=w("h1"),a=I("Loading tags..."),this.h()},l:function(f){t=x(f,"H1",{});var c=P(t);a=A(c,"Loading tags..."),c.forEach(h),this.h()},h:function(){D(t,E,119,4,3520)},m:function(f,c){k(f,t,c),N(t,a)},p:H,i:H,o:H,d:function(f){f&&h(t)}};return B("SvelteRegisterBlock",{block:n,id:mt.name,type:"if",source:"(119:2) {#if $tagsQuery.fetching}",ctx:o}),n}function dt(o){let t=o[16].name+"",a;const n={c:function(){a=I(t)},l:function(f){a=A(f,t)},m:function(f,c){k(f,a,c)},p:function(f,c){c&2&&t!==(t=f[16].name+"")&&ft(a,t)},d:function(f){f&&h(a)}};return B("SvelteRegisterBlock",{block:n,id:dt.name,type:"slot",source:'(127:10) <svelte:fragment slot=\\"summary\\">',ctx:o}),n}function ht(o){let t,a=o[16],n,e,f,c,s,l,u,i,m,$;function C(){o[7].call(t,o[17],o[18])}const T=()=>o[8](t,a),d=()=>o[8](null,a);function v(){return o[9](o[16])}function S(...b){return o[10](o[16],...b)}const O={c:function(){t=w("input"),n=Q(),e=w("span"),f=I("Human-Readable name of the tag that is shown in UI"),c=Q(),s=w("button"),l=w("span"),u=I("Delete"),i=Q(),this.h()},l:function(g){t=x(g,"INPUT",{type:!0,class:!0,placeholder:!0}),n=q(g),e=x(g,"SPAN",{slot:!0});var y=P(e);f=A(y,"Human-Readable name of the tag that is shown in UI"),y.forEach(h),c=q(g),s=x(g,"BUTTON",{class:!0});var r=P(s);l=x(r,"SPAN",{});var p=P(l);u=A(p,"Delete"),p.forEach(h),r.forEach(h),i=q(g),this.h()},h:function(){R(t,"type","text"),R(t,"class","input p-2"),R(t,"placeholder","Tag-Name"),D(t,E,128,12,3838),R(e,"slot","helper"),D(e,E,135,12,4083),D(l,E,138,14,4269),R(s,"class","btn variant-ghost-error"),D(s,E,137,12,4174)},m:function(g,y){k(g,t,y),X(t,o[16].name),T(),k(g,n,y),k(g,e,y),N(e,f),k(g,c,y),k(g,s,y),N(s,l),N(l,u),k(g,i,y),m||($=[_(t,"input",C),_(t,"change",v,!1,!1,!1,!1),_(s,"click",S,!1,!1,!1,!1)],m=!0)},p:function(g,y){o=g,y&2&&t.value!==o[16].name&&X(t,o[16].name),a!==o[16]&&(d(),a=o[16],T())},d:function(g){g&&h(t),d(),g&&h(n),g&&h(e),g&&h(c),g&&h(s),g&&h(i),m=!1,xt($)}};return B("SvelteRegisterBlock",{block:O,id:ht.name,type:"slot",source:'(128:10) <svelte:fragment slot=\\"content\\">',ctx:o}),O}function G(o){let t,a;t=new at({props:{$$slots:{content:[ht],summary:[dt]},$$scope:{ctx:o}},$$inline:!0});const n={c:function(){it(t.$$.fragment)},l:function(f){ct(t.$$.fragment,f)},m:function(f,c){lt(t,f,c),a=!0},p:function(f,c){const s={};c&524294&&(s.$$scope={dirty:c,ctx:f}),t.$set(s)},i:function(f){a||(F(t.$$.fragment,f),a=!0)},o:function(f){j(t.$$.fragment,f),a=!1},d:function(f){rt(t,f)}};return B("SvelteRegisterBlock",{block:n,id:G.name,type:"each",source:"(125:6) {#each tags as tag}",ctx:o}),n}function pt(o){let t,a,n=o[1];M(n);let e=[];for(let s=0;s<n.length;s+=1)e[s]=G(et(o,n,s));const f=s=>j(e[s],1,1,()=>{e[s]=null}),c={c:function(){for(let l=0;l<e.length;l+=1)e[l].c();t=W()},l:function(l){for(let u=0;u<e.length;u+=1)e[u].l(l);t=W()},m:function(l,u){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(l,u);k(l,t,u),a=!0},p:function(l,u){if(u&102){n=l[1],M(n);let i;for(i=0;i<n.length;i+=1){const m=et(l,n,i);e[i]?(e[i].p(m,u),F(e[i],1)):(e[i]=G(m),e[i].c(),F(e[i],1),e[i].m(t.parentNode,t))}for(ot(),i=n.length;i<e.length;i+=1)f(i);st()}},i:function(l){if(!a){for(let u=0;u<n.length;u+=1)F(e[u]);a=!0}},o:function(l){e=e.filter(Boolean);for(let u=0;u<e.length;u+=1)j(e[u]);a=!1},d:function(l){wt(e,l),l&&h(t)}};return B("SvelteRegisterBlock",{block:c,id:pt.name,type:"slot",source:"(124:4) <Accordion>",ctx:o}),c}function L(o){let t,a,n,e;const f=[mt,gt,ut],c=[];function s(u,i){return u[0].fetching?0:u[0].error?1:2}a=s(o),n=c[a]=f[a](o);const l={c:function(){t=w("div"),n.c(),this.h()},l:function(i){t=x(i,"DIV",{class:!0});var m=P(t);n.l(m),m.forEach(h),this.h()},h:function(){R(t,"class","card"),D(t,E,117,0,3469)},m:function(i,m){k(i,t,m),c[a].m(t,null),e=!0},p:function(i,[m]){let $=a;a=s(i),a===$?c[a].p(i,m):(ot(),j(c[$],1,1,()=>{c[$]=null}),st(),n=c[a],n?n.p(i,m):(n=c[a]=f[a](i),n.c()),F(n,1),n.m(t,null))},i:function(i){e||(F(n),e=!0)},o:function(i){j(n),e=!1},d:function(i){i&&h(t),c[a].d()}};return B("SvelteRegisterBlock",{block:l,id:L.name,type:"component",source:"",ctx:o}),l}function Et(o,t,a){let n,{$$slots:e={},$$scope:f}=t;yt("Page",e,[]);const c=V();let s=[];const l={},u={};let i=-1;const m=J({query:Y,client:c,variables:{}});kt(m,"tagsQuery"),bt(o,m,r=>a(0,n=r));const $=K();function C(){if(s.find(r=>r.name=="New Tag"))l[s[s.length-1].id].setOpen(!0),u[s[s.length-1].id].focus();else{const r={id:i--,name:"New Tag"};s.push(r),a(1,s),a(0,n),setTimeout(()=>{l[r.id].setOpen(!0);const p=u[r.id];p.focus(),p.getElement().querySelectorAll("input")[0].select()},0)}}async function T(r){if(r.name=="New Tag")return;let p=!1;if(r.id<0){try{const U=await c.mutation(z,{tagName:r.name}).toPromise();U.data&&(r.id=U.data.createTag.id,p=!0)}catch(U){console.log(U)}if(!p){$.trigger({message:`Failed to create Tag '${r.name}'!`,background:"variant-filled-error",timeout:2e3});return}}else{try{p=(await c.mutation(tt,{tagID:r.id,tagName:r.name}).toPromise()).data.updateTag!=null}catch{}if(!p){$.trigger({message:`Failed to update Tag '${r.name}'!`,background:"variant-filled-error",timeout:2e3});return}}$.trigger({message:`Tag '${r.name}' saved!`,background:"variant-filled-success",timeout:2e3})}async function d(r){if(r.name!="New Tag"){let p=!1;try{p=(await c.mutation(Z,{tagID:r.id}).toPromise()).data.deleteTag}catch{p=!1}if(!p){$.trigger({message:`Failed to remove Tag '${r.name}'!`,background:"variant-filled-error",timeout:2e3});return}}$.trigger({message:`Tag '${r.name}' removed!`,background:"variant-filled-success",timeout:2e3})}function v(r,p){r.stopPropagation(),d(p)}const S=[];Object.keys(t).forEach(r=>{!~S.indexOf(r)&&r.slice(0,2)!=="$$"&&r!=="slot"&&Dt.warn(`<Page> was created with unknown prop '${r}'`)});function O(r,p){r[p].name=this.value,a(1,s),a(0,n)}function b(r,p){St[r?"unshift":"push"](()=>{u[p.id]=r,a(2,u)})}const g=r=>T(r),y=(r,p)=>v(p,r);return o.$capture_state=()=>({getContextClient:V,queryStore:J,CreateTagDocument:z,DeleteTagDocument:Z,GetTagsDocument:Y,UpdateTagDocument:tt,Accordion:nt,AccordionItem:at,getToastStore:K,client:c,tags:s,panels:l,nameFields:u,tagNegativeID:i,tagsQuery:m,toastStore:$,newTag:C,tagChange:T,deleteTag:d,onDeleteClick:v,$tagsQuery:n}),o.$inject_state=r=>{"tags"in r&&a(1,s=r.tags),"tagNegativeID"in r&&(i=r.tagNegativeID)},t&&"$$inject"in t&&o.$inject_state(t.$$inject),o.$$.update=()=>{o.$$.dirty&1&&a(1,s=n.data?.getTags||[])},[n,s,u,m,C,T,v,O,b,g,y]}class Bt extends $t{constructor(t){super(t),vt(this,t,Et,L,Tt,{}),B("SvelteRegisterComponent",{component:this,tagName:"Page",options:t,id:L.name})}}export{Bt as component};
//# sourceMappingURL=7.1806f2d6.js.map
