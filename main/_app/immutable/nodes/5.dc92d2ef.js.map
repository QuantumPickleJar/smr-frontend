{"version":3,"file":"5.dc92d2ef.js","sources":["../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.ts","../../../../../../src/routes/admin/sml-versions/[smlVersionId]/edit/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\nexport const load: PageLoad = async ({ params }) => ({\n  ...params\n});\n","<script lang=\"ts\">\n  import { getContextClient, queryStore } from '@urql/svelte';\n  import { GetSmlVersionAdminDocument, UpdateSmlVersionDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import type { SMLVersionData } from '$lib/models/sml-versions';\n  import SMLVersionForm from '$lib/components/sml-versions/SMLVersionForm.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import Card, { Content } from '@smui/card';\n  import type { PageData } from './$types';\n\n  export let data: PageData;\n\n  $: ({ smlVersionId } = data);\n\n  const client = getContextClient();\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  const smlVersion = queryStore({\n    query: GetSmlVersionAdminDocument,\n    client,\n    variables: { smlVersionID: smlVersionId }\n  });\n\n  const onSubmit = (smlVersionData: SMLVersionData) => {\n    client\n      .mutation(UpdateSmlVersionDocument, {\n        smlVersionID: smlVersionId,\n        smlVersion: smlVersionData\n      })\n      .toPromise()\n      .then((value) => {\n        if (value.error) {\n          console.error(value.error.message);\n          errorMessage = 'Error editing SMLVersion: ' + value.error.message;\n          errorToast = true;\n        } else {\n          // TODO Toast or something\n          goto(base + '/admin/sml-versions');\n        }\n      });\n  };\n\n  $: if (!errorToast) {\n    errorMessage = '';\n  }\n\n  $: initialValues = $smlVersion.data\n    ? ({\n        ...$smlVersion.data.getSMLVersion,\n        logo: undefined\n      } as unknown as SMLVersionData)\n    : undefined;\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Edit SML Version\" title=\"Admin: Edit SML Version\" />\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit SMLVersion</h1>\n\n<Card>\n  <Content>\n    {#if $smlVersion.fetching}\n      <p>Loading...</p>\n    {:else if $smlVersion.error}\n      <p>Oh no... {$smlVersion.error.message}</p>\n    {:else}\n      <SMLVersionForm {onSubmit} {initialValues} submitText=\"Save\" />\n    {/if}\n  </Content>\n</Card>\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":["load","async","params","ctx","error","message","insert_hydration","target","p","anchor","set_data","t1","t1_value","fetching","span","h1","data","$$props","client","getContextClient","errorMessage","errorToast","smlVersion","queryStore","query","GetSmlVersionAdminDocument","variables","smlVersionID","smlVersionId","onSubmit","smlVersionData","mutation","UpdateSmlVersionDocument","toPromise","then","value","console","$$invalidate","goto","base","initialValues","$smlVersion","getSMLVersion","logo","undefined"],"mappings":"ghBAEO,MAAMA,GAAiBC,MAASC,CAAAA,OAAAA,CAAAA,KAAc,IAChDA,sbCkEcC,EAAW,CAAA,EAACC,MAAMC,QAAO,6BAAnC,WAAA,8CAAA,WAAA,gCAAHC,EAA0CC,EAAAC,EAAAC,CAAAA,oCAA7BN,EAAW,CAACC,EAAAA,MAAMC,QAAO,KAAAK,EAAAC,EAAAC,0EAFnC,mDAAA,YAAA,uBAAHN,EAAgBC,EAAAC,EAAAC,yGADb,OAAAN,KAAYU,SAAQ,EAEfV,KAAYC,MAAK,ypBAStBD,EAAY,4CAAZA,EAAY,CAAA,CAAA,uBAAnBG,EAA0BC,EAAAO,EAAAL,2BAAnBN,EAAY,CAAA,CAAA,kRADAA,EAAU,wBAAVA,EAAU,+FAdK,wMAAA,gLAApCG,EAAAA,EAAuDC,EAAAQ,EAAAN,8LAclCN,EAAU,qQAhElBa,CAAAA,EAAcC,EAInB,MAAAC,EAASC,EAAAA,EAEX,IAAAC,EAAe,GACfC,EAAa,GAEX,MAAAC,EAAaC,EAAU,CAC3BC,MAAOC,EACPP,SACAQ,UAAS,CAAIC,aAAcC,CAAAA,CAAAA,CAAAA,kBAGvB,CAAA,EAAA,MAAAC,EAAYC,GAAAA,CAChBZ,EACGa,SAASC,GAAwB,CAChCL,aAAcC,EACdN,WAAYQ,CAEbG,CAAAA,EAAAA,UAAAA,EACAC,KAAMC,GAAAA,CACDA,EAAM/B,OACRgC,QAAQhC,MAAM+B,EAAM/B,MAAMC,OAC1BgC,EAAAA,EAAA,EAAAjB,EAAe,6BAA+Be,EAAM/B,MAAMC,OAC1DgC,EAAAA,EAAA,EAAAhB,EAAa,KAGbiB,EAAKC,EAAO,uCAmCDlB,CAAAA,EAAUc,wFA9DvBP,CAAAA,aAAAA,CAAAA,EAAiBZ,kBAgCfK,GACNgB,EAAA,EAAAjB,EAAe,EAAA,iBAGdiB,EAAA,EAAAG,EAAgBC,EAAYzB,MAEtByB,GAAAA,EAAYzB,KAAK0B,cACpBC,KAAMC,MAAAA,EAERA"}