{"version":3,"file":"TagList.nyod_nU-.js","sources":["../../../../../../src/lib/components/utils/TagDisplay.svelte","../../../../../../src/lib/components/utils/TagList.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { type Tag } from '$lib/generated';\n  import { popup, type PopupSettings } from '@skeletonlabs/skeleton';\n  export let tag: Tag;\n  export let popupTriggerEvent: PopupSettings['event'] | null = 'click';\n\n  $: popupHover = {\n    event: popupTriggerEvent,\n    target: `popupHoverFor${tag.name}`,\n    placement: 'bottom-start'\n  } satisfies PopupSettings;\n</script>\n\n<div\n  class=\"lowercase text-neutral-300 [&>*]:pointer-events-none\"\n  use:popup={popupHover}\n  title=\"Click for tag information\">\n  <span class=\"text-orange-500\">#</span>{tag.name}\n</div>\n\n<!-- Must use high z-index to ensure it draws on top of things like striped compatibility overlays in mod cards -->\n<!-- https://floating-ui.com/docs/misc#z-index-stacking -->\n<div class=\"card variant-filled-surface p-4\" data-popup={`popupHoverFor${tag.name}`} style=\"z-index: 1000\">\n  <p>TODO Tag information will appear here.</p>\n  <br />\n  <p>Use Mod Tags to filter your searches and quickly find similar mods.</p>\n  <div class=\"variant-filled-surface arrow\" />\n</div>\n","<script lang=\"ts\">\n  import { GetTagsDocument } from '$lib/generated/graphql';\n  import type { Tag } from '$lib/generated/graphql';\n  import { queryStore, getContextClient } from '@urql/svelte';\n  import { Autocomplete, type AutocompleteOption, InputChip, type PopupSettings, popup } from '@skeletonlabs/skeleton';\n  import { onMount } from 'svelte';\n  import TagDisplay from './TagDisplay.svelte';\n\n  const client = getContextClient();\n\n  const getAllTags = queryStore({\n    query: GetTagsDocument,\n    client,\n    variables: {\n      limit: 100\n    }\n  });\n\n  export let tags: Tag[] = [];\n  export let editable = false;\n  export let popupTriggerEvent: PopupSettings['event'] = 'click';\n\n  $: allTags =\n    $getAllTags.data?.getTags?.map((t) => ({\n      label: `${t.name} - ${'TODO: Tag description this will become a very long string sometimes yes long string'}`,\n      value: t.id\n    })) || ([] satisfies AutocompleteOption[]);\n\n  const popupSettings: PopupSettings = {\n    event: 'focus-click',\n    target: 'popupAutocomplete',\n    placement: 'bottom-start'\n  };\n\n  let tagList = [];\n  const loadTagList = () => (tagList = tags.map((t: Tag) => t.name));\n\n  onMount(loadTagList);\n\n  const addTag = (tag: AutocompleteOption) => {\n    tags = [\n      ...tags,\n      {\n        id: tag.value,\n        name: tag.label\n      }\n    ];\n\n    loadTagList();\n  };\n\n  const removeTag = (label: string) => {\n    const idx = tags.findIndex((t) => t.name === label);\n    tags = [...tags.slice(0, idx), ...tags.slice(idx + 1)];\n\n    loadTagList();\n  };\n\n  let inputTag = '';\n</script>\n\n<div class=\"tags\">\n  {#if !editable}\n    {#if tags.length > 0}\n      <div class=\"text-md flex flex-row flex-wrap gap-1\">\n        {#each tags as tag}\n          <TagDisplay {tag} {popupTriggerEvent} />\n        {/each}\n      </div>\n    {/if}\n  {:else}\n    <div class=\"mb-2\">Tags</div>\n\n    <div use:popup={popupSettings}>\n      <InputChip\n        bind:input={inputTag}\n        bind:value={tagList}\n        on:remove={(t) => removeTag(t.detail.chipValue)}\n        name=\"tags\"\n        chips=\"variant-filled-primary\" />\n    </div>\n\n    <div class=\"card max-h-48 w-max max-w-full overflow-y-auto p-4\" tabindex=\"-1\" data-popup=\"popupAutocomplete\">\n      <Autocomplete\n        bind:input={inputTag}\n        options={allTags.filter((t) => tagList.indexOf(t.label) < 0)}\n        on:selection={(t) => addTag(t.detail)} />\n    </div>\n  {/if}\n</div>\n"],"names":["t1_value","ctx","name","attr_dev","div2","div2_data_popup_value","insert_hydration_dev","target","div0","anchor","append_hydration_dev","span","p0","br","p1","div1","dirty","set_data_dev","t1","tag","$$props","popupTriggerEvent","popupHover","event","placement","options","filter","autocomplete_changes","length","create_if_block_1","i","div","each_blocks","client","getContextClient","getAllTags","queryStore","query","GetTagsDocument","variables","limit","tags","editable","popupSettings","tagList","loadTagList","$$invalidate","map","t","onMount","addTag","id","value","label","removeTag","idx","findIndex","slice","inputTag","remove_handler","detail","chipValue","indexOf","selection_handler","allTags","$getAllTags","data","getTags"],"mappings":"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"}